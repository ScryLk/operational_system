<!doctype html>
<html lang="pt-br">

<head>
  <!-- Pré-Configurações -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Todos os CSS -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css"
    integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous">
  <!--<link rel="stylesheet" href="_config/node_modules/@fortawesome/fontawesome-free/css/fontawesome.min.css"/>-->
  <link rel="stylesheet" href="css.css">
</head>

<body>
  <!--Conteudo-->
  <div class="container">
    <div class="row">

    </div>

    <div class="row justify-content-center">
      <div class="col-6">
        <div class="form-row">
          
          <form autocomplete="off">
            <h4>Criação de Processos</h4><button class="btn btn-info" onclick="explication()" style="cursor: pointer;">Explicação</button><br><br>
            <div class="form-group row col-12">
              <label for="nome_processo" class="col-form-label col-3" style="">Nome:</label>
              <div class="col-7">
                <input id="nome_processo" type="text" class="form-control" name="firstname" value="">
              </div>
            </div>
            <div class="form-group row col-12">
              <label for="tamanho_processo" class="col-form-label col-3">Tamanho(KB):</label>
              <div class="col-9">
                <input id="tamanho_processo" class="form-control col-9" min="1" type="number" name="lastname" value="">
              </div>
            </div>
            <input type="button" onclick="addProcess()" class="btn btn-primary" style="margin-left: 0px;"
              value="Criar Processo">
          </form>
          </br>
          <fieldset>
            <legend>Tabela de processos</legend>
            <table id="processos" style="width:100%">
              <tr>
                <th>PID</th>
                <th>Nome</th>
                <th>Tamanho</th>
              </tr>

            </table>
            <input type="button" onclick="allocAllProcess()" class="btn btn-primary mt-3" value="Alocar Processos">
            <button onclick="" class="btn btn-warning mt-3 ml-3">Resetar</button>
          </fieldset>



        </div>
      </div>
    </div>
   
    <div class="col-6">
      <div class="tooltip">
        <h4>Criar Partição</h4>

      </div>
      <h6 id="tamanho_disponivel">Disponível: 400kb</h6>
      <div>
        <form>
          <div class="form-group row col-12">
            <label for="tamanho_processo" class="col-form-label col-2">Tamanho:</label>
            <div class="col-3">
              <input id="tamanho_particao" class="form-control" min="1" type="number" name="lastname" value="">
            </div>
            <input type="button" onclick="addPartition()" class="btn btn-primary" value="Criar Partição">
          </div>


        </form>
      </div>

      <fieldset>
        <legend>Tabela de Partições</legend>
        <table id="particoes" style="width:100%">
          <tr>
            <th>Tamanho</th>
          </tr>

        </table>
        <button onclick="" class="btn btn-warning my-3 ml-3">Resetar</button>
      </fieldset>

    </div>

    <div class="row justify-content-center col-6">
      <div class="col-6">
        <div class="tooltip">
          <h4>Best Fit</h4>
          <span class="tooltiptext">Best Fit: Estratégia de alocação de memória que escolhe o bloco mais próximo do tamanho necessário, otimizando o uso de recursos.</span>
        </div>
    
      <table id="bestfit" style="width:100%">
        <tr>
          <th>PID</th>
          <th class="">nome</th>
          <th>Tamanho</th>
        </tr>

      </table>
      <button onclick="" class="btn btn-warning my-3">Resetar</button>
    </div>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

    <!--/Conteudo-->

    <!--Modal-->
    <!--/Modal-->

    <!-- Todos os JavaScript -->
    <!-- jQuery, Popper.js e Bootstrap JS -->
    <script src="_config/node_modules/jquery/dist/jquery.min.js"></script>
    <script src="_config/node_modules/popper.js/dist/popper.min.js"></script>
    <script src="_config/node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="_javascript/funcoes.js"></script>
    <!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>-->

    <script>

      var pid_count = 0;
      var memoria_disponivel = 400;


      class Processo {
        constructor(pid, nome, tamanho) {
          this.pid = pid;
          this.nome = nome;
          this.tamanho = tamanho;

        }
      }

      class Particao {
        constructor(tamanho) {
          this.process = null;
          this.tamanho = tamanho;
        }

      }

      var lista_processos = new Array();
      var lista_particoes = new Array();

      function allocAllProcess() {
        var lista_best_fit = JSON.parse(JSON.stringify(lista_particoes));
        for (var i = 0; i < lista_processos.length; i++) {
          var particao_index = null;
          var processo_i = lista_processos[i];
          for (var j = 0; j < lista_best_fit.length; j++) {
            var particao_j = lista_best_fit[j];
            if (particao_j.process == null) {
              alert("A alocação de processos Best Fit aloca memória escolhendo o bloco mais próximo do tamanho exato necessário, minimizando desperdício, mas potencialmente aumentando a fragmentação.");
              if (particao_index != null) {

                if (parseInt(processo_i.tamanho, 10) <= parseInt(particao_j.tamanho, 10) && parseInt(lista_best_fit[particao_index].tamanho, 10) > parseInt(particao_j.tamanho, 10)) {
                  particao_index = j;

                }
              }
              else {
                if (parseInt(processo_i.tamanho, 10) <= parseInt(particao_j.tamanho, 10)) {
                  particao_index = j;
                }
              }
            }

          }
          //inserir na lista best fit
          if (particao_index != null) {
            lista_best_fit[particao_index].process = processo_i;
            if (parseInt(processo_i.tamanho, 10) < parseInt(lista_best_fit[particao_index].tamanho, 10)) {
              var tamanho_restante = lista_best_fit[particao_index].tamanho - processo_i.tamanho;
              lista_best_fit[particao_index].tamanho = processo_i.tamanho;
              lista_best_fit.splice(particao_index + 1, 0, new Particao(tamanho_restante));

            }
          }
          else {
            alert("Nenhuma partição disponível para o processo \"" + processo_i.nome + "\"");
          }
        }

        $("#bestfit td").remove();
        // Popula a Tabela Best Fit
        for (var j = 0; j < lista_best_fit.length; j++) {
          var newRow = document.getElementById('bestfit').insertRow();
          if (lista_best_fit[j].process != null) {
            newRow.innerHTML = "<td height=\"" + lista_best_fit[j].tamanho + "\" >" + lista_best_fit[j].process.pid + "</td>" + "<td>" + lista_best_fit[j].process.nome + "</td>" + "<td>" + lista_best_fit[j].tamanho + " KB</td>";
            newRow.className = 'processo';
          }
          else {
            newRow.innerHTML = "<td height=\"" + lista_best_fit[j].tamanho + "\" >" + "N/D" + "</td>" + "<td>" + "Área Livre" + "</td>" + "<td>" + lista_best_fit[j].tamanho + " KB</td>";
            newRow.className = 'livre';
          }
        }



        // worst fit

        var lista_worst_fit = JSON.parse(JSON.stringify(lista_particoes));
        for (var i = 0; i < lista_processos.length; i++) {
          var particao_index = null;
          var processo_i = lista_processos[i];
          for (var j = 0; j < lista_worst_fit.length; j++) {
            var particao_j = lista_worst_fit[j];
            if (particao_j.process == null) {
              if (particao_index != null) {

                if (parseInt(processo_i.tamanho, 10) <= parseInt(particao_j.tamanho, 10) && parseInt(lista_worst_fit[particao_index].tamanho, 10) < parseInt(particao_j.tamanho, 10)) {
                  particao_index = j;
                }
              }
              else {
                if (parseInt(processo_i.tamanho, 10) <= parseInt(particao_j.tamanho, 10)) {
                  particao_index = j;
                }
              }
            }

          }



          //inserir na lista worst fit
          if (particao_index != null) {
            lista_worst_fit[particao_index].process = processo_i;
            if (parseInt(processo_i.tamanho, 10) < parseInt(lista_worst_fit[particao_index].tamanho, 10)) {
              var tamanho_restante = lista_worst_fit[particao_index].tamanho - processo_i.tamanho;
              lista_worst_fit[particao_index].tamanho = processo_i.tamanho;
              lista_worst_fit.splice(particao_index + 1, 0, new Particao(tamanho_restante));
            }
          }
          else {
            alert("Nenhuma partição disponível para o processo \"" + processo_i.nome + "\"");
          }
        }

        $("#worstfit td").remove();
        // Popula a Tabela worst Fit
        for (var j = 0; j < lista_worst_fit.length; j++) {
          var newRow = document.getElementById('worstfit').insertRow();
          if (lista_worst_fit[j].process != null) {
            newRow.innerHTML = "<td height=\"" + lista_worst_fit[j].tamanho + "\" >" + lista_worst_fit[j].process.pid + "</td>" + "<td>" + lista_worst_fit[j].process.nome + "</td>" + "<td>" + lista_worst_fit[j].tamanho + " KB</td>";
            newRow.className = 'processo';
          }
          else {
            newRow.innerHTML = "<td height=\"" + lista_worst_fit[j].tamanho + "\" >" + "N/D" + "</td>" + "<td>" + "Área Livre" + "</td>" + "<td>" + lista_worst_fit[j].tamanho + " KB</td>";
            newRow.className = 'livre';
          }
        }



        // first Fit

        var lista_first_fit = JSON.parse(JSON.stringify(lista_particoes));
        for (var i = 0; i < lista_processos.length; i++) {
          var particao_index = null;
          var processo_i = lista_processos[i];
          for (var j = 0; j < lista_first_fit.length; j++) {
            var particao_j = lista_first_fit[j];
            if (particao_j.process == null) {
              if (parseInt(processo_i.tamanho, 10) <= parseInt(particao_j.tamanho, 10)) {
                particao_index = j;
                break

              }

            }

          }
          //inserir na lista worst fit
          if (particao_index != null) {
            lista_first_fit[particao_index].process = processo_i;
            if (parseInt(processo_i.tamanho, 10) < parseInt(lista_first_fit[particao_index].tamanho, 10)) {
              var tamanho_restante = lista_first_fit[particao_index].tamanho - processo_i.tamanho;
              lista_first_fit[particao_index].tamanho = processo_i.tamanho;
              lista_first_fit.splice(particao_index + 1, 0, new Particao(tamanho_restante));
            }
          }
          else {
            alert("Nenhuma partição disponível para o processo \"" + processo_i.nome + "\"");
          }
        }

        $("#firstfit td").remove();
        // Popula a Tabela worst Fit
        for (var j = 0; j < lista_first_fit.length; j++) {
          var newRow = document.getElementById('firstfit').insertRow();
          if (lista_first_fit[j].process != null) {
            newRow.innerHTML = "<td height=\"" + lista_first_fit[j].tamanho + "\" >" + lista_first_fit[j].process.pid + "</td>" + "<td>" + lista_first_fit[j].process.nome + "</td>" + "<td>" + lista_first_fit[j].tamanho + " KB</td>";
            newRow.className = 'processo';
          }
          else {
            newRow.innerHTML = "<td height=\"" + lista_first_fit[j].tamanho + "\" >" + "N/D" + "</td>" + "<td>" + "Área Livre" + "</td>" + "<td>" + lista_first_fit[j].tamanho + " KB</td>";
            newRow.className = 'livre';
          }
        }


      }


      function addPartition() {
        var tamanho_particao = document.getElementById('tamanho_particao').value;
        if (tamanho_particao != "") {
          if (memoria_disponivel >= tamanho_particao) {
            var newRow = document.getElementById('particoes').insertRow();
            newRow.innerHTML = "<td>" + tamanho_particao + " KB</td>";
            memoria_disponivel -= tamanho_particao;
            $("#tamanho_disponivel").text("Disponível: " + memoria_disponivel + " KB");

            lista_particoes.push(new Particao(tamanho_particao));
            alert("A partição refere-se à divisão de algo em partes distintas ou à criação de seções separadas. Esse conceito é aplicado em diversos contextos, como em computação, onde a partição de discos divide o armazenamento em unidades independentes, ou em estatísticas, onde a partição de dados implica separá-los para análise específica. Em geral, a partição é uma estratégia utilizada para organizar, gerenciar ou analisar elementos, tornando mais fácil lidar com eles de maneira mais eficiente e específica. ")
            alert("Você criou a PARTIÇÃO e definiu o TAMANHO dela, se caso você não tenha um processo, crie, se caso já tenha, apenas vá na TABELA DE PROCESSOS e aperte em ALOCAR PROCESSOS");

          }
          else {
            alert("Memoria insuficiente!");
          }
        }
        else {
          alert("Insira os campos necessários!");
        }
      }

      function addProcess() {
        var nome_processo = document.getElementById('nome_processo').value;
        var tamanho_processo = document.getElementById('tamanho_processo').value;
        if (nome_processo != "" && tamanho_processo != "") {
          var newRow = document.getElementById('processos').insertRow();
          newRow.innerHTML = "<td>" + pid_count + "</td>" + "<td>" + nome_processo + "</td><td>" + tamanho_processo + " KB</td>";
          pid_count++;
          lista_processos.push(new Processo(pid_count, nome_processo, tamanho_processo));
          alert("A criação de processos é um componente essencial na gestão organizacional, envolvendo a definição e estabelecimento de procedimentos sistemáticos para realizar atividades de forma eficiente e eficaz.");
          alert("Você preencheu o NOME e o TAMANHO do seu processo, agore crie a partição");
        }
        else {
          alert("Insira os campos necessários!");
        }
      }

      function explication() {
        alert("Motivo da Criação de processos: A criação de processos visa estabelecer procedimentos sistemáticos para realizar atividades de maneira eficiente e eficaz dentro de uma organização, buscando consistência, qualidade e otimização operacional");
        alert("O Best Fit é uma estratégia de alocação de memória que procura alocar o menor bloco de memória próximo ao tamanho exato necessário para um processo, minimizando o desperdício de memória. No entanto, essa abordagem pode aumentar a fragmentação do espaço de memória.")
      }

    </script>

</body>

</html>